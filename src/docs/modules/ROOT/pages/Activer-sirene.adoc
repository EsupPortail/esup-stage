= Activer l'API Sirene

== Création du compte

Pour activer l'API Sirene, vous devez d'abord créer un compte sur le site de l'INSEE :
https://portail-api.insee.fr/

Cliquez sur le bouton « Se connecter » en haut à droite de la page.

image::accueil_portail_insee.png[Texte alternatif]

Puis, cliquez sur « Connexion pour les externes ».

image::login_portail_insee.png[Texte alternatif]

Ensuite, cliquez sur « S'enregistrer ».

image::premiere_page_connexion.png[Texte alternatif]

Vous devrez remplir un formulaire avec vos informations. Assurez-vous de fournir une adresse e-mail valide, car vous recevrez un e-mail de confirmation.

image::inscription.png[Texte alternatif]

== Création de l'application

Pour utiliser l'API Sirene, vous devez créer une application sur le portail de l'INSEE.
Une fois connecté, allez dans la section « Mes applications » et cliquez sur « Créer une application ».

image::insee_application.png[Texte alternatif]

Remplissez au moins le nom de l'application et la description.
Vous pouvez laisser les autres champs vides pour l'instant, puis cliquez sur Suivant.

image::etape1_application.png[Texte alternatif]

Pour le champ « type », saisissez « web » et cliquez sur Suivant.

image::etape2_application.png[Texte alternatif]

Dans l'étape « Souscription », c’est ici que vous allez choisir l’API Sirene.
Cliquez sur la barre de recherche et tapez « sirene ».
Ajoutez l’API Sirene à la liste des souscriptions de votre application.

image::etape3_application.png[Texte alternatif]

== Récupérer le token

Pour récupérer le token, allez dans la section « Mes applications » et cliquez sur l'application que vous venez de créer.

Allez ensuite dans la partie « Souscriptions » et cliquez sur l’API « Sirene ».

Vous pouvez maintenant récupérer le token dans la section « Clés d’API ».

image::ROOT::application_souscriptions.png[Texte alternatif]

== Configuration de l'application

Pour activer l’API Sirene dans votre application, vous devez renseigner les informations suivantes dans le fichier de configuration application.properties :
[,properties]
----
sirene.url=https://api.insee.fr/api-sirene/3.11
sirene.token=[votre_token]
sirene.nombre_minimum_resultats=3
----

== Problèmes techniques connus

=== Échec des appels à l’API Sirene

*Symptôme* ::
Les appels vers l’API Sirene échouent avec une erreur « connexion refusée ».

*Cause identifiée* ::
La JVM ne connaît pas le proxy réseau à utiliser.
Le serveur devait passer par un proxy non configuré dans Java.

=== Solutions possibles

. Ouvrir les accès réseau sortants
. Configurer le proxy dans les options Java

