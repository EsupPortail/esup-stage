<mat-card>
  <mat-card-content>
    <form [formGroup]="form" novalidate>
      <div class="mt-3 mb-3">

        <div class="text-title">Modèle de la convention</div>
        <mat-divider class="mb-2"></mat-divider>
        <div class="row">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Langue de la convention</mat-label>
            <mat-select formControlName="codeLangueConvention" required>
              <mat-option *ngFor="let langueConvention of langueConventions" [value]="langueConvention.code">{{langueConvention.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('codeLangueConvention')"></app-form-error></mat-error>
          </mat-form-field>

          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Pays de la convention</mat-label>
            <mat-select formControlName="idPays" required>
              <mat-option *ngFor="let country of countries" [value]="country.id">{{country.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idPays')"></app-form-error></mat-error>
          </mat-form-field>

          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Type de convention</mat-label>
            <mat-select formControlName="idTypeConvention" required>
              <mat-option *ngFor="let typeConvention of typeConventions" [value]="typeConvention.id">{{typeConvention.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idTypeConvention')"></app-form-error></mat-error>
          </mat-form-field>
        </div>

        <div class="text-title">Description du stage</div>
        <mat-divider class="mb-2"></mat-divider>
        <div class="row">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Thèmatique du stage</mat-label>
            <mat-select formControlName="idTheme" required>
              <mat-option *ngFor="let thematique of thematiques" [value]="thematique.id">{{thematique.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idTheme')"></app-form-error></mat-error>
          </mat-form-field>
        </div>
        <div class="row">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Sujet</mat-label>
            <textarea matInput formControlName="sujetStage" required ></textarea>
            <mat-error><app-form-error [field]="form.get('sujetStage')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Compétences</mat-label>
            <textarea matInput formControlName="competences" required ></textarea>
            <mat-error><app-form-error [field]="form.get('competences')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Fonctions et tâches</mat-label>
            <textarea matInput formControlName="fonctionsEtTaches" required ></textarea>
            <mat-error><app-form-error [field]="form.get('fonctionsEtTaches')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Détails</mat-label>
            <textarea matInput formControlName="details"></textarea>
            <mat-error><app-form-error [field]="form.get('sujet')"></app-form-error></mat-error>
          </mat-form-field>
        </div>

        <div class="text-title">Dates / horaires</div>
        <mat-divider class="mb-2"></mat-divider>
        <div class="row">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Date de début du stage</mat-label>
            <input matInput [min]="minDateDebutStage" [max]="maxDateDebutStage" [matDatepicker]="dateDebutStagePicker"
                   (dateChange)="dateDebutChanged($event)" formControlName="dateDebutStage" required>
            <mat-datepicker-toggle matSuffix [for]="dateDebutStagePicker"></mat-datepicker-toggle>
            <mat-datepicker #dateDebutStagePicker></mat-datepicker>
            <mat-error><app-form-error [field]="form.get('dateDebutStage')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Date de fin du stage</mat-label>
            <input matInput  [min]="minDateFinStage" [max]="maxDateFinStage" [matDatepicker]="dateFinStagePicker" formControlName="dateFinStage" required>
            <mat-datepicker-toggle matSuffix [for]="dateFinStagePicker"></mat-datepicker-toggle>
            <mat-datepicker #dateFinStagePicker></mat-datepicker>
            <mat-error><app-form-error [field]="form.get('dateFinStage')"></app-form-error></mat-error>
          </mat-form-field>

          <div class="col-sm-12 col-md-12 mb-2">
            <div class="mb-2">Interruption au cours du stage ?</div>
            <mat-radio-group formControlName="interruptionStage" (change)="setInterruptionStageFormControls($event)">
              <mat-radio-button [value]="true">Oui</mat-radio-button>
              <mat-radio-button [value]="false">Non</mat-radio-button>
            </mat-radio-group>
          </div>
        </div>

        <div class="row" *ngIf="form.value.interruptionStage">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Date de début d'interruption du stage </mat-label>
            <input matInput [matDatepicker]="dateDebutInterruptionPicker" formControlName="dateDebutInterruption" required >
            <mat-datepicker-toggle matSuffix [for]="dateDebutInterruptionPicker"></mat-datepicker-toggle>
            <mat-datepicker #dateDebutInterruptionPicker></mat-datepicker>
            <mat-error><app-form-error [field]="form.get('dateDebutInterruption')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Date de fin d'interruption du stage </mat-label>
            <input matInput [matDatepicker]="dateFinInterruptionPicker" formControlName="dateFinInterruption" required >
            <mat-datepicker-toggle matSuffix [for]="dateFinInterruptionPicker"></mat-datepicker-toggle>
            <mat-datepicker #dateFinInterruptionPicker></mat-datepicker>
            <mat-error><app-form-error [field]="form.get('dateFinInterruption')"></app-form-error></mat-error>
          </mat-form-field>
        </div>

        <div class="row">
          <div class="col-sm-12 col-md-12 mb-2">
            <div class="mb-2" >Avez-vous des horaires de travail réguliers</div>
            <mat-radio-group formControlName="horairesReguliers" (change)="setHorairesReguliersFormControls($event)">
              <mat-radio-button [value]="true">Oui</mat-radio-button>
              <mat-radio-button [value]="false">Non</mat-radio-button>
            </mat-radio-group>
          </div>
        </div>
        <div class="row" *ngIf="form.value.horairesReguliers">
          <mat-form-field class="col-sm-6 col-md-6 mb-2" appearance="fill">
            <mat-label>Nombre d’heures hebdomadaires du stage</mat-label>
            <input matInput formControlName="nbHeuresHebdo" required />
            <mat-error><app-form-error [field]="form.get('nbHeuresHebdo')"></app-form-error></mat-error>
          </mat-form-field>
        </div>
        <div class="row" *ngIf="!form.value.horairesReguliers">
          <div class="col-6 mb-3">
            <button mat-button mat-flat-button type="button" color="primary" (click)="openCalendar()">Calcul du nombre d'heures de stages</button>
          </div>
        </div>
        <div class="row">
          <mat-form-field class="col-6 mb-2" appearance="fill">
            <mat-label>Durée effective du stage en nombre d'heures</mat-label>
            <input type="number" matInput formControlName="quotiteTravail" required />
            <mat-error><app-form-error [field]="form.get('quotiteTravail')"></app-form-error></mat-error>
          </mat-form-field>
        </div>
        <div class="row">
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Temps de travail</mat-label>
            <mat-select formControlName="idTempsTravail" required>
              <mat-option *ngFor="let tempsTravail of tempsTravails" [value]="tempsTravail.id">{{tempsTravail.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idTempsTravail')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Commentaire sur le temps de travail</mat-label>
            <textarea matInput formControlName="commentaireDureeTravail"></textarea>
            <mat-error><app-form-error [field]="form.get('commentaireDureeTravail')"></app-form-error></mat-error>
          </mat-form-field>
        </div>

        <div class="text-title">Gratification</div>
        <mat-divider class="mb-2"></mat-divider>
        <div class="row">
          <div class="col-sm-12 col-md-12 mb-2">
            <div class="mb-2">Gratification au cours du stage ?</div>
            <mat-radio-group formControlName="gratificationStage" (change)="setGratificationStageFormControls($event)">
              <mat-radio-button [value]="true">Oui</mat-radio-button>
              <mat-radio-button [value]="false">Non</mat-radio-button>
            </mat-radio-group>
          </div>
        </div>
        <div class="row" *ngIf="form.value.gratificationStage">
          <mat-form-field class="col-sm-6 col-md-6 mb-2" appearance="fill">
            <mat-label>Montant de la gratification</mat-label>
            <input matInput formControlName="montantGratification" required />
            <mat-error><app-form-error [field]="form.get('montantGratification')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-3 col-md-3 mb-2" appearance="fill">
            <mat-select formControlName="idUniteGratification" required>
              <mat-option *ngFor="let uniteGratification of uniteGratifications" [value]="uniteGratification.id">{{uniteGratification.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idUniteGratification')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-3 col-md-3 mb-2" appearance="fill">
            <mat-select formControlName="idUniteDuree" required>
              <mat-option *ngFor="let uniteDuree of uniteDurees" [value]="uniteDuree.id">{{uniteDuree.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idUniteDuree')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Monnaie utilisée pour le paiement</mat-label>
            <mat-select formControlName="idDevise" required>
              <mat-option *ngFor="let devise of devises" [value]="devise.id">{{devise.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idDevise')"></app-form-error></mat-error>
          </mat-form-field>
          <mat-form-field class="col-sm-12 col-md-6 mb-2" appearance="fill">
            <mat-label>Modalité de versement de la gratification</mat-label>
            <mat-select formControlName="idModeVersGratification" required>
              <mat-option *ngFor="let modeVersGratification of modeVersGratifications" [value]="modeVersGratification.id">{{modeVersGratification.libelle}}</mat-option>
            </mat-select>
            <mat-error><app-form-error [field]="form.get('idModeVersGratification')"></app-form-error></mat-error>
          </mat-form-field>
        </div>

        <div class="text-title">Divers</div>
        <mat-divider class="mb-2"></mat-divider>
        <div class="row">
          <div class="row col-sm-12 col-md-6">
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Comment le stage a-t-il été trouvé ?</mat-label>
              <mat-select formControlName="idOrigineStage" required>
                <mat-option *ngFor="let origineStage of origineStages" [value]="origineStage.id">{{origineStage.libelle}}</mat-option>
              </mat-select>
              <mat-error><app-form-error [field]="form.get('idOrigineStage')"></app-form-error></mat-error>
            </mat-form-field>
            <div class="col-12 mb-2">
              <div class="mb-2">Confidentialité du stage / Thème du stage</div>
              <mat-radio-group formControlName="confidentiel">
                <mat-radio-button [value]="true">Oui</mat-radio-button>
                <mat-radio-button [value]="false">Non</mat-radio-button>
              </mat-radio-group>
            </div>
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Nature du travail à fournir suite au stage</mat-label>
              <mat-select formControlName="idNatureTravail" required>
                <mat-option *ngFor="let natureTravail of natureTravails" [value]="natureTravail.id">{{natureTravail.libelle}}</mat-option>
              </mat-select>
              <mat-error><app-form-error [field]="form.get('idNatureTravail')"></app-form-error></mat-error>
            </mat-form-field>
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Modalité de validation du stage</mat-label>
              <mat-select formControlName="idModeValidationStage" required>
                <mat-option *ngFor="let modeValidationStage of modeValidationStages" [value]="modeValidationStage.id">{{modeValidationStage.libelle}}</mat-option>
              </mat-select>
              <mat-error><app-form-error [field]="form.get('idModeValidationStage')"></app-form-error></mat-error>
            </mat-form-field>
          </div>
          <div class="row col-sm-12 col-md-6">
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Modalité de suivi du stagiaire</mat-label>
              <textarea matInput formControlName="modeEncadreSuivi"></textarea>
              <mat-error><app-form-error [field]="form.get('modeEncadreSuivi')"></app-form-error></mat-error>
            </mat-form-field>
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Liste des avantages en nature</mat-label>
              <textarea matInput formControlName="avantagesNature"></textarea>
              <mat-error><app-form-error [field]="form.get('avantagesNature')"></app-form-error></mat-error>
            </mat-form-field>
            <mat-form-field class="col-12 mb-2" appearance="fill">
              <mat-label>Si le stagiaire doit être présent la nuit, le dimanche, ou un jour férié, préciser :</mat-label>
              <textarea matInput formControlName="travailNuitFerie"></textarea>
              <mat-error><app-form-error [field]="form.get('travailNuitFerie')"></app-form-error></mat-error>
            </mat-form-field>
          </div>
        </div>

      </div>
    </form>
  </mat-card-content>
</mat-card>
