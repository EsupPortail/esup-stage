<mat-accordion>
  <mat-expansion-panel #generalPanel [expanded]="!edit">
    <mat-expansion-panel-header>
      <mat-panel-title>Évaluation du stage</mat-panel-title>
    </mat-expansion-panel-header>
    <div class="mt-3" *ngIf="!isEnseignant">
      <div *ngIf="isGestionnaireOrAdmin">
        <div class="text-title">Évaluation par l'étudiant</div>
        <mat-divider class="mb-2"></mat-divider>
      </div>

      <div class="mt-3 mb-2 danger-color" *ngIf="!ficheEvaluation || !ficheEvaluation.validationEtudiant">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'a pas encore été validée par le centre de gestion.
      </div>
      <div class="mt-3 mb-2 danger-color" *ngIf="ficheEvaluation && ficheEvaluation.validationEtudiant && (!reponseEvaluation || !reponseEvaluation.validationEtudiant)">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'est pas encore renseignée.
      </div>
      <div class="mt-3 mb-2 success-color" *ngIf="reponseEvaluation && reponseEvaluation.validationEtudiant">
        <i class="fa fa-check"></i>&nbsp;Cette évaluation a bien été renseignée.
      </div>
      <div class="mt-2">
        <button mat-button mat-stroked-button color="primary" (click)="editFicheEtudiant()" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEtudiant">Éditer la fiche</button>
        <button mat-button mat-stroked-button color="primary" (click)="printFiche(0)" *ngIf="reponseEvaluation && reponseEvaluation.validationEtudiant">Imprimer</button>
      </div>
      <div *ngIf="isGestionnaireOrAdmin && ficheEvaluation && ficheEvaluation.validationEtudiant && (!reponseEvaluation || !reponseEvaluation.validationEtudiant)">
        <mat-divider class="mt-2 mb-2"></mat-divider>
        <div class="mt-3 mb-2 danger">Cliquez sur le bouton ci-dessous afin d'envoyer un mail prévenant l'étudiant ({{convention.etudiant.mail}}) qu'il peut remplir sa fiche.</div>
        <button class="mb-2" mat-button mat-stroked-button color="primary" (click)="envoiMailEvaluation(0)"><i style="vertical-align: initial;" class="fa fa-envelope"></i>&nbsp;Envoyer</button>
      </div>

    </div>
    <div class="mt-3" *ngIf="!isEtudiant">
      <div *ngIf="isGestionnaireOrAdmin">
        <div class="text-title">Évaluation par l'enseignant référent</div>
        <mat-divider class="mb-2"></mat-divider>
      </div>

      <div class="mt-3 mb-2 danger-color" *ngIf="!ficheEvaluation || !ficheEvaluation.validationEnseignant">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'a pas encore été validée par le centre de gestion.
      </div>
      <div class="mt-3 mb-2 danger-color" *ngIf="ficheEvaluation && ficheEvaluation.validationEnseignant && (!reponseEvaluation || !reponseEvaluation.validationEnseignant)">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'est pas encore renseignée.
      </div>
      <div class="mt-3 mb-2 success-color" *ngIf="reponseEvaluation && reponseEvaluation.validationEnseignant">
        <i class="fa fa-check"></i>&nbsp;Cette évaluation a bien été renseignée.
      </div>
      <div class="mt-2">
        <button mat-button mat-stroked-button color="primary" (click)="editFicheEnseignant()" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEnseignant">Éditer la fiche</button>
        <button mat-button mat-stroked-button color="primary" (click)="printFiche(1)" *ngIf="reponseEvaluation && reponseEvaluation.validationEnseignant">Imprimer</button>
      </div>
      <div *ngIf="isGestionnaireOrAdmin && ficheEvaluation && ficheEvaluation.validationEtudiant && (!reponseEvaluation || !reponseEvaluation.validationEtudiant)">
        <mat-divider class="mt-2 mb-2"></mat-divider>
        <div class="mt-3 mb-2 danger">Cliquez sur le bouton ci-dessous afin d'envoyer un mail prévenant l'enseignant ({{convention.enseignant.mail}}) qu'il peut remplir sa fiche.</div>
        <button class="mb-2" mat-button mat-stroked-button color="primary" (click)="envoiMailEvaluation(1)"><i style="vertical-align: initial;" class="fa fa-envelope"></i>&nbsp;Envoyer</button>
      </div>
    </div>

    <div class="mt-3" *ngIf="isGestionnaireOrAdmin">
      <div *ngIf="isGestionnaireOrAdmin">
        <div class="text-title">Appréciation du tuteur professionnel</div>
        <mat-divider class="mb-2"></mat-divider>
      </div>

      <div class="mt-3 mb-2 danger-color" *ngIf="!ficheEvaluation || !ficheEvaluation.validationEntreprise">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'a pas encore été validée par le centre de gestion.
      </div>
      <div class="mt-3 mb-2 danger-color" *ngIf="ficheEvaluation && ficheEvaluation.validationEntreprise && (!reponseEvaluation || !reponseEvaluation.validationEntreprise)">
        <i class="fa fa-times"></i>&nbsp;Cette évaluation n'est pas encore renseignée.
      </div>
      <div class="mt-3 mb-2 success-color" *ngIf="reponseEvaluation && reponseEvaluation.validationEntreprise">
        <i class="fa fa-check"></i>&nbsp;Cette évaluation a bien été renseignée.
      </div>
      <div class="mt-2">
        <button mat-button mat-stroked-button color="primary" (click)="editFicheEntreprise()" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEntreprise">Éditer la fiche</button>
        <button mat-button mat-stroked-button color="primary" (click)="printFiche(2)" *ngIf="reponseEvaluation && reponseEvaluation.validationEntreprise">Imprimer</button>
      </div>
      <div *ngIf="isGestionnaireOrAdmin && ficheEvaluation && ficheEvaluation.validationEtudiant && (!reponseEvaluation || !reponseEvaluation.validationEtudiant)">
        <mat-divider class="mt-2 mb-2"></mat-divider>
        <div class="mt-3 mb-2 danger">Cliquez sur le bouton ci-dessous afin d'envoyer un mail prévenant le tuteur professionnel ({{convention.contact.mail}}) qu'il peut remplir sa fiche.</div>
        <button class="mb-2" mat-button mat-stroked-button color="primary" (click)="envoiMailEvaluation(2)"><i style="vertical-align: initial;" class="fa fa-envelope"></i>&nbsp;Envoyer</button>
      </div>
    </div>

  </mat-expansion-panel>

  <mat-expansion-panel #etuPanel [expanded]="editEtu" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEtudiant" *ngIf="isEtudiant || isGestionnaireOrAdmin">
    <mat-expansion-panel-header>
      <mat-panel-title>Évaluation par l'étudiant</mat-panel-title>
      <mat-panel-description>
        <div class="w-100 text-right">
          <mat-icon fontSet="fa" fontIcon="fa-user"></mat-icon>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-accordion *ngIf="ficheEvaluation && ficheEvaluation.validationEtudiant">
      <form [formGroup]="reponseEtudiantForm" novalidate (submit)="saveReponse(0)">
        <mat-expansion-panel #etuTab1Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Avant le départ en stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'EtuI5'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="mb-2">{{convention.origineStage.libelle}}</div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'EtuI7'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="reponseEtuI7">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                  <div class="row mb-2" *ngIf="reponseEtudiantForm.get('reponseEtuI7')?.value === true">
                    <div class="col-12 mb-2">Si oui, par qui ?</div>
                    <mat-radio-group style="display: grid" formControlName="reponseEtuI7bis1">
                      <mat-radio-button style="margin-left: 16px" *ngFor="let line of question.texte | slice:0:5; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                    </mat-radio-group>
                  </div>
                  <div class="row mb-2" *ngIf="reponseEtudiantForm.get('reponseEtuI7')?.value === false">
                    <div class="col-12 mb-2">Si non, pourquoi ?</div>
                    <mat-radio-group style="display: grid" formControlName="reponseEtuI7bis2">
                      <mat-radio-button style="margin-left: 16px" *ngFor="let line of question.texte | slice:5:7; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                    </mat-radio-group>
                  </div>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEtudiantForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[0]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel #etuTab2Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Pendant le stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'EtuII5'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="reponseEtuII5">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                  <div class="row mb-2" *ngIf="reponseEtudiantForm.get('reponseEtuII5')?.value === true">
                    <div class="col-12 mb-2">Si oui : a) De quel ordre ?</div>
                    <mat-radio-group style="display: grid" formControlName="reponseEtuII5a">
                      <mat-radio-button style="margin-left: 16px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                    </mat-radio-group>
                    <div class="col-12 mb-2">b) Avec autonomie ?</div>
                    <mat-radio-group formControlName="reponseEtuII5b">
                      <mat-radio-button style="margin-left: 16px" [value]="true">Oui</mat-radio-button>
                      <mat-radio-button style="margin-left: 16px" [value]="false">Non</mat-radio-button>
                    </mat-radio-group>
                  </div>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEtudiantForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[1]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel #etuTab3Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Après le stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIIIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'EtuIII1'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="mb-2">{{convention.sujetStage}}</div>
                </div>
                <div class="col-md-12">
                  <div class="mb-2"><b>L'avez-vous modifié ?</b></div>
                </div>
                <div class="col-sm-12">
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEtudiantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEtudiantForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[2]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <div class="row mt-3">
          <div class="col-sm-6">
            <button type="button" mat-button mat-stroked-button color="warn" (click)="cancelEdit()">{{'BOUTON_ANNULER'|contenu}}</button>
          </div>
          <div class="col-sm-6 text-right">
            <button mat-button mat-flat-button color="primary">{{'BOUTON_VALIDER'|contenu}}</button>
          </div>
        </div>
      </form>
    </mat-accordion>
  </mat-expansion-panel>

  <mat-expansion-panel #ensPanel [expanded]="editEns" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEnseignant" *ngIf="isEnseignant || isGestionnaireOrAdmin">
    <mat-expansion-panel-header>
      <mat-panel-title>Évaluation par l'enseignant</mat-panel-title>
      <mat-panel-description>
        <div class="w-100 text-right">
          <mat-icon fontSet="fa" fontIcon="fa-user"></mat-icon>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-accordion *ngIf="ficheEvaluation && ficheEvaluation.validationEnseignant">
      <form [formGroup]="reponseEnseignantForm" novalidate (submit)="saveReponse(1)">
        <mat-expansion-panel #ensTab1Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Suivi du stagiaire pendant son stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEnseignantIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEnseignantForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[3]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel #ensTab2Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Evaluation du stagiaire</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEnseignantIIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEnseignantForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEnseignantForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[4]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <div class="row mt-3">
          <div class="col-sm-6">
            <button type="button" mat-button mat-stroked-button color="warn" (click)="cancelEdit()">{{'BOUTON_ANNULER'|contenu}}</button>
          </div>
          <div class="col-sm-6 text-right">
            <button mat-button mat-flat-button color="primary">{{'BOUTON_VALIDER'|contenu}}</button>
          </div>
        </div>
      </form>
    </mat-accordion>
  </mat-expansion-panel>

  <mat-expansion-panel #entPanel [expanded]="editEnt" [disabled]="!ficheEvaluation ||!ficheEvaluation.validationEntreprise" *ngIf="isGestionnaireOrAdmin">
    <mat-expansion-panel-header>
      <mat-panel-title>Appréciation du tuteur professionnel</mat-panel-title>
      <mat-panel-description>
        <div class="w-100 text-right">
          <mat-icon fontSet="fa" fontIcon="fa-user"></mat-icon>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-accordion *ngIf="ficheEvaluation && ficheEvaluation.validationEntreprise">
      <form [formGroup]="reponseEntrepriseForm" novalidate (submit)="saveReponse(2)">
        <mat-expansion-panel #entTab1Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Savoir être du stagiaire</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEntrepriseIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEntrepriseForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[5]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel #entTab2Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Savoir faire du stagiaire</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEntrepriseIIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEntrepriseForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[6]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel #entTab3Panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Appréciation générale du stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEntrepriseIIIQuestions">
            <div *ngIf="ficheEvaluation['question' + question.controlName]">
              <div class="row mb-2" *ngIf="question.type == 'boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button [value]="true">Oui</mat-radio-button>
                    <mat-radio-button [value]="false">Non</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionTrue &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === true)">
                  <div class="mb-2"><b>{{question.bisQuestionTrue}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionFalse &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value === false)">
                  <div class="mb-2"><b>{{question.bisQuestionFalse}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                    <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestionLowNotation &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value !== null) &&
                 (reponseEntrepriseForm.get('reponse' + question.controlName)?.value >= 3)">
                  <div class="mb-2"><b>{{question.bisQuestionLowNotation}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12 mt-2 mb-2" *ngIf="question.bisQuestion">
                  <div class="mb-2"><b>{{question.bisQuestion}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName + 'bis'}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <div class="row" *ngFor="let line of question.texte; let ind = index">
                    <div class="col-sm-3">
                      {{line}}
                    </div>
                    <div class="col-sm-9">
                      <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                        <mat-radio-button [value]="true">Oui</mat-radio-button>
                        <mat-radio-button [value]="false">Non</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2" *ngIf="question.type == 'texte'">
                <div class="col-md-12">
                  <div class="mb-2"><b>{{question.title}}</b></div>
                  <mat-form-field style="width: 100%" appearance="fill">
                    <textarea matInput formControlName="{{'reponse' + question.controlName}}"></textarea>
                  </mat-form-field>
                </div>
              </div>
              <mat-divider class="mt-2 mb-2"></mat-divider>
            </div>
          </div>
          <div *ngIf="questionsSupplementaires">
            <form [formGroup]="reponseSupplementaireEntrepriseForm" novalidate>
              <div class="mt-2 mb-2" *ngFor="let questionSupplementaire of questionsSupplementaires[7]">
                <div class="mb-2"><b>{{questionSupplementaire.question}}</b></div>
                <mat-form-field style="width: 100%" *ngIf="questionSupplementaire.typeQuestion == 'txt'" appearance="fill">
                  <textarea matInput formControlName="{{questionSupplementaire.formControlName}}"></textarea>
                </mat-form-field>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'not'" style="display: grid" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button style="margin-left: 0px" [value]="0">Excellent</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="1">Très bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="2">Bien</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="3">Satisfaisant</mat-radio-button>
                  <mat-radio-button style="margin-left: 0px" [value]="4">Insuffisant</mat-radio-button>
                </mat-radio-group>
                <mat-radio-group *ngIf="questionSupplementaire.typeQuestion == 'yn'" formControlName="{{questionSupplementaire.formControlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
                <mat-divider class="mt-2 mb-2"></mat-divider>
              </div>
            </form>
          </div>
        </mat-expansion-panel>

        <div class="row mt-3">
          <div class="col-sm-6">
            <button type="button" mat-button mat-stroked-button color="warn" (click)="cancelEdit()">{{'BOUTON_ANNULER'|contenu}}</button>
          </div>
          <div class="col-sm-6 text-right">
            <button mat-button mat-flat-button color="primary">{{'BOUTON_VALIDER'|contenu}}</button>
          </div>
        </div>
      </form>
    </mat-accordion>
  </mat-expansion-panel>

</mat-accordion>
