<mat-accordion>
  <mat-expansion-panel [expanded]="!edit">
    <mat-expansion-panel-header>
      <mat-panel-title>Évaluation du stage</mat-panel-title>
    </mat-expansion-panel-header>
    <div class="mt-3">
      <div class="text-title">Évaluation par l'étudiant</div>

      Cette évaluation n'est pas encore renseignée.
      <button mat-button mat-stroked-button color="primary" (click)="editFicheEtudiant()">Éditer la fiche</button>

      Cliquez sur le bouton ci-dessous afin d'envoyer un mail prévenant l'étudiant ({{convention.etudiant.mail}}) qu'il peut remplir sa fiche.
      <button mat-button mat-stroked-button color="primary" (click)="editFicheEtudiant()">Envoyer</button>

      <mat-divider class="mb-2"></mat-divider>
      <div class="text-title">Évaluation par l'enseignant référent</div>
      <mat-divider class="mb-2"></mat-divider>
      <div class="text-title">Appréciation du tuteur professionnel</div>
      <mat-divider class="mb-2"></mat-divider>
    </div>

  </mat-expansion-panel>

  <mat-expansion-panel [expanded]="editEtu">
    <mat-expansion-panel-header>
      <mat-panel-title>Évaluation par l'étudiant</mat-panel-title>
      <mat-panel-description>
        <div class="w-100 text-right">
          <mat-icon fontSet="fa" fontIcon="fa-user"></mat-icon>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-accordion>
      <form [formGroup]="reponseEtudiantForm" novalidate (submit)="saveReponseEtudiant()">

        <mat-expansion-panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Avant le départ en stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIQuestions">
            <div class="row mb-2" *ngIf="question.type == 'boolean'">
              <div class="col-md-12">
                <div class="mb-2">{{question.title}}</div>
                <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
            <div class="row mb-2" *ngIf="question.type == 'multiple-choice'">
              <div class="col-md-12">
                <div class="mb-2"><b>{{question.title}}</b></div>
                <mat-radio-group style="display: grid" formControlName="{{'reponse' + question.controlName}}">
                  <mat-radio-button style="margin-left: 0px" *ngFor="let line of question.texte; let ind = index" [value]="ind">{{line}}</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
            <div class="row mb-2" *ngIf="question.type == 'multiple-boolean'">
              <div class="col-md-12">
                <div class="mb-2"><b>{{question.title}}</b></div>
                <div class="row" *ngFor="let line of question.texte; let ind = index">
                  <div class="col-sm-3">
                    {{line}}
                  </div>
                  <div class="col-sm-9">
                    <mat-radio-group formControlName="{{'reponse' + question.controlName + controlsIndexToLetter[ind]}}">
                      <mat-radio-button [value]="true">Oui</mat-radio-button>
                      <mat-radio-button [value]="false">Non</mat-radio-button>
                    </mat-radio-group>
                  </div>
                </div>
              </div>
            </div>
            <mat-divider class="mt-2 mb-2"></mat-divider>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Pendant le stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-3 mb-3">
            <div class="row">
              <div class="col-sm-3">Questions</div>
              <div class="col-sm-9">Activation</div>
            </div>
            <mat-divider class="mt-2 mb-2"></mat-divider>
          </div>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIIQuestions">
            <div class="row mb-2" *ngIf="question.type == 'boolean'">
              <div class="col-md-12">
                <div class="mb-2">{{question.title}}</div>
                <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
            <mat-divider class="mt-2 mb-2"></mat-divider>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>Après le stage</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="mt-3 mb-3">
            <div class="row">
              <div class="col-sm-3">Questions</div>
              <div class="col-sm-9">Activation</div>
            </div>
            <mat-divider class="mt-2 mb-2"></mat-divider>
          </div>
          <div class="mt-2 mb-2" *ngFor="let question of FicheEtudiantIIIQuestions">
            <div class="row mb-2" *ngIf="question.type == 'boolean'">
              <div class="col-md-12">
                <div class="mb-2">{{question.title}}</div>
                <mat-radio-group formControlName="{{'reponse' + question.controlName}}">
                  <mat-radio-button [value]="true">Oui</mat-radio-button>
                  <mat-radio-button [value]="false">Non</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
            <mat-divider class="mt-2 mb-2"></mat-divider>
          </div>
        </mat-expansion-panel>

        <div class="row mt-3">
          <div class="col-sm-6">
            <button mat-button mat-stroked-button color="warn" (click)="cancelEdit()">{{'BOUTON_ANNULER'|contenu}}</button>
          </div>
          <div class="col-sm-6 text-right">
            <button mat-button mat-flat-button color="primary">{{'BOUTON_VALIDER'|contenu}}</button>
          </div>
        </div>
      </form>
    </mat-accordion>

  </mat-expansion-panel>
</mat-accordion>
